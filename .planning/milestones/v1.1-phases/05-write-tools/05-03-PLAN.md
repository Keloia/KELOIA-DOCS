---
phase: 05-write-tools
plan: 03
type: execute
wave: 2
depends_on:
  - 05-01
files_modified:
  - mcp-server/dist/index.js
autonomous: false

must_haves:
  truths:
    - "Claude Code shows 7 tools in /mcp status for the keloia server"
    - "Asking Claude to add a task creates a new task file and updates the kanban index"
    - "Asking Claude to move a task changes the task's column"
    - "Asking Claude to update milestone progress writes the new values"
    - "Invalid inputs return clear error messages"
  artifacts:
    - path: "mcp-server/dist/index.js"
      provides: "Built server with all 7 tools"
  key_links:
    - from: "mcp-server/dist/index.js"
      to: "data/kanban/"
      via: "write tools create/modify task files"
      pattern: "atomicWriteJson"
    - from: "mcp-server/dist/index.js"
      to: "data/progress/"
      via: "update_progress writes milestone files"
      pattern: "atomicWriteJson"
---

<objective>
Build the MCP server and verify all three write tools work end-to-end in Claude Code via natural language.

Purpose: Proves the write tools are functional, correctly registered, and usable by Claude without prompt hints.
Output: Built dist/, verified tool behavior, phase complete.
</objective>

<execution_context>
@/Users/enjat/.claude/get-shit-done/workflows/execute-plan.md
@/Users/enjat/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-write-tools/05-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build the MCP server with write tools</name>
  <files>mcp-server/dist/index.js</files>
  <action>
Run `cd /Users/enjat/Github/keloia/keloia-docs/mcp-server && npm run build` to compile TypeScript to dist/.

Verify the build succeeds with zero errors. The built output should now include all write tool code.

After build, the user must restart the MCP server in Claude Code (close and reopen Claude Code, or use `/mcp` to reconnect). The tool count should increase from 4 to 7.
  </action>
  <verify>Build completes with zero errors. `ls mcp-server/dist/tools/write.js` confirms write module was built.</verify>
  <done>mcp-server/dist/ contains the compiled write tools alongside existing read tools.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify write tools in Claude Code</name>
  <files>data/kanban/task-005.json</files>
  <action>
Human verification checkpoint. Three MCP write tools (keloia_add_task, keloia_move_task, keloia_update_progress) were built and are ready for Claude Code verification.

Steps for the user:
1. Open Claude Code in the repo root (or restart if already open to pick up new build)
2. Run `/mcp` — verify keloia shows 7 tools (was 4 in Phase 4)
3. Ask Claude: "Add a task called 'Test write tools' to the backlog" — should create task-005.json and update index.json
4. Ask Claude: "Move task-005 to In Progress" — should update task-005.json column field
5. Ask Claude: "Update milestone-05 progress to in-progress with 1 of 3 tasks completed" — should update milestone-05.json
6. Ask Claude: "Move task-999 to Done" — should return an error naming the valid task IDs
7. Verify data files were actually written: check data/kanban/task-005.json exists and data/kanban/index.json lists task-005

Resume signal: Type "approved" if all 7 steps pass, or describe which step failed and the error message.
  </action>
  <verify>User confirms all 7 verification steps pass. /mcp shows 7 tools. Write operations produce correct files on disk.</verify>
  <done>All three write tools verified working in Claude Code. Phase 5 success criteria from ROADMAP satisfied.</done>
</task>

</tasks>

<verification>
1. Build succeeds with zero errors
2. /mcp shows 7 tools for keloia server
3. keloia_add_task creates a file and updates index
4. keloia_move_task changes the column
5. keloia_update_progress updates milestone fields
6. Invalid task ID returns isError with known task list
7. Data files on disk reflect the mutations
</verification>

<success_criteria>
- MCP server builds cleanly
- All 7 tools appear in Claude Code /mcp
- Write tools create/modify actual JSON files on disk
- Error handling returns clear messages for invalid inputs
- Phase 5 success criteria from ROADMAP all satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-write-tools/05-03-SUMMARY.md`
</output>
