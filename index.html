<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keloia Docs</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/lib/marked.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/minisearch@7.2.0/dist/umd/index.min.js"></script>
  <script>
    // Apply saved theme immediately to prevent flash
    (function() {
      var saved = localStorage.getItem('keloia_theme');
      if (!saved) {
        saved = window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
      }
      document.documentElement.setAttribute('data-theme', saved);
    })();
  </script>
  <script src="github.js" defer></script>
  <script src="app.js" defer></script>
</head>
<body>
  <nav id="sidebar">
    <div class="sidebar-header">
      <h1 class="site-title">Keloia</h1>
    </div>

    <button type="button" id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
      <span class="theme-toggle-icon">ðŸŒ™</span>
      <span class="theme-toggle-label">Dark</span>
    </button>

    <div class="search-container">
      <button type="button" id="search-trigger" class="search-trigger">
        <span class="search-trigger-text">Search docs...</span>
        <kbd class="search-trigger-kbd">âŒ˜K</kbd>
      </button>
    </div>

    <section class="nav-section">
      <div class="nav-section-header">
        <h3 class="nav-section-title">Docs</h3>
        <button class="btn-icon auth-only" id="new-doc-btn" title="New Doc">+</button>
      </div>
      <ul id="doc-list"></ul>
    </section>

    <section class="nav-section">
      <h3 class="nav-section-title">Views</h3>
      <ul class="nav-list">
        <li><a href="#/kanban" data-view="kanban">Kanban</a></li>
        <li><a href="#/progress" data-view="progress">Progress</a></li>
        <li><a href="#/mcp" data-view="mcp">MCP Integration</a></li>
      </ul>
    </section>

    <section class="nav-section" id="auth-section">
      <div class="unauth-only">
        <input
          type="password"
          id="token-input"
          class="token-input"
          placeholder="GitHub PAT..."
          autocomplete="off"
        />
        <button id="login-btn" class="btn-auth">Login</button>
        <p id="login-error" class="login-error" hidden></p>
      </div>
      <div class="auth-only">
        <button id="logout-btn" class="btn-auth btn-logout">Logout</button>
      </div>
    </section>
  </nav>

  <div id="search-modal" class="search-modal-overlay" hidden>
    <div class="search-modal-box">
      <div class="search-modal-header">
        <input type="search" id="search-modal-input" placeholder="Search products, pages, and features..." autocomplete="off" />
        <kbd class="search-kbd">Esc</kbd>
      </div>
      <ul id="search-modal-results" class="search-modal-results"></ul>
      <div class="search-modal-footer">
        <span><kbd>&uarr;</kbd><kbd>&darr;</kbd> to navigate</span>
        <span><kbd>Enter</kbd> to select</span>
      </div>
    </div>
  </div>

  <div class="content-area">
    <main id="main"></main>
  </div>

  <button id="mobile-menu-btn" class="mobile-menu-btn" aria-label="Toggle menu">
    <span></span><span></span><span></span>
  </button>
  <div id="sidebar-backdrop" class="sidebar-backdrop"></div>
</body>
</html>
